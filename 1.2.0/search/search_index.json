{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Introduction Feedback Vascular Image Lab (VIL) members: please submit user feedbacks via MS Form . General Pipeline Welcome to the new MOCHA software. MOCHA aims to build a joint analysis pipeline for multi-modal/contrast/sequence (collectively referred to as multi-sequence for simplicity) vascular images, including: Convert raw image data (Dicom files) to a MOCHA project (folder containing NIFTI files) Registration of multi-sequence 3D images Exporting images as iCafe format for centerline tracing using iCafe or AICafe Reading centerline data (swc files) from iCafe, and use it to extract multi-sequence 2D cross-sectional images from the registered images Manual contour labeling on 2D cross-sectional images (similar to 2D CASCADE) Feature measurements and statistical analysis based on annotated labels. Entire workflow of MOCHA. The software will provide a GUI to facilitate the above functionality. Deep learning based models will also be introduced to perform automated segmentation of tissues such as vessel lumen, wall, and different types of plaques/pathology.","title":"Introduction"},{"location":"#introduction","text":"Feedback Vascular Image Lab (VIL) members: please submit user feedbacks via MS Form .","title":"Introduction"},{"location":"#general-pipeline","text":"Welcome to the new MOCHA software. MOCHA aims to build a joint analysis pipeline for multi-modal/contrast/sequence (collectively referred to as multi-sequence for simplicity) vascular images, including: Convert raw image data (Dicom files) to a MOCHA project (folder containing NIFTI files) Registration of multi-sequence 3D images Exporting images as iCafe format for centerline tracing using iCafe or AICafe Reading centerline data (swc files) from iCafe, and use it to extract multi-sequence 2D cross-sectional images from the registered images Manual contour labeling on 2D cross-sectional images (similar to 2D CASCADE) Feature measurements and statistical analysis based on annotated labels. Entire workflow of MOCHA. The software will provide a GUI to facilitate the above functionality. Deep learning based models will also be introduced to perform automated segmentation of tissues such as vessel lumen, wall, and different types of plaques/pathology.","title":"General Pipeline"},{"location":"Installation/","text":"Windows 10 or higher The software can be downloaded from MS Sharepoint after logging in with your UW account. If you are a member of the Vascular Imaging Lab, but do not have download permission, please contact Xin Wang. After download you will get a zip file. Unzip it (password is mocha ) and then you can open the software by double-clicking an executable file named mocha.exe in the root folder. MacOS or Linux Please contact Xin Wang for a workable version of the software on these operating systems. A download link will be available on this webpage in the future.","title":"Installation"},{"location":"Installation/#windows-10-or-higher","text":"The software can be downloaded from MS Sharepoint after logging in with your UW account. If you are a member of the Vascular Imaging Lab, but do not have download permission, please contact Xin Wang. After download you will get a zip file. Unzip it (password is mocha ) and then you can open the software by double-clicking an executable file named mocha.exe in the root folder.","title":"Windows 10 or higher"},{"location":"Installation/#macos-or-linux","text":"Please contact Xin Wang for a workable version of the software on these operating systems. A download link will be available on this webpage in the future.","title":"MacOS or Linux"},{"location":"Contour%20Labeling%20Tool/","text":"Introduction Feedback Vascular Image Lab (VIL) members: please submit user feedbacks via MS Form . This tool is for manual contour labeling on 2D cross-sectional images generated from vessel centerlines. It serves as a replacement of related functions in 2D CASCADE.","title":"Introduction"},{"location":"Contour%20Labeling%20Tool/#introduction","text":"Feedback Vascular Image Lab (VIL) members: please submit user feedbacks via MS Form . This tool is for manual contour labeling on 2D cross-sectional images generated from vessel centerlines. It serves as a replacement of related functions in 2D CASCADE.","title":"Introduction"},{"location":"Contour%20Labeling%20Tool/AI%20Prediction/","text":"You can use AI to preform automated contour labeling. Lumen and outer wall segmentation Currently, we support to predict \"Lumen\" and \"Outer Wall\" contours. To do so, click the menubar, AI \u2192 Lumen/Wall Seg , then a prompt window will appear Here, you can select one single image sequence to perform the prediction. For best performance, it is recommended to use pre-contrast T1 or a similar sequence. You can choose to only predict contours for those slice without lumen or outer wall contours through a check box. It is checked by default. You can determine the range of slices to predict by changing the values in the two text boxes. The default range is all the slices (from the first to the last one). Once the options are good, click OK and wait for seconds. The predicted lumen and outer wall contours will appear.","title":"AI Prediction"},{"location":"Contour%20Labeling%20Tool/AI%20Prediction/#lumen-and-outer-wall-segmentation","text":"Currently, we support to predict \"Lumen\" and \"Outer Wall\" contours. To do so, click the menubar, AI \u2192 Lumen/Wall Seg , then a prompt window will appear Here, you can select one single image sequence to perform the prediction. For best performance, it is recommended to use pre-contrast T1 or a similar sequence. You can choose to only predict contours for those slice without lumen or outer wall contours through a check box. It is checked by default. You can determine the range of slices to predict by changing the values in the two text boxes. The default range is all the slices (from the first to the last one). Once the options are good, click OK and wait for seconds. The predicted lumen and outer wall contours will appear.","title":"Lumen and outer wall segmentation"},{"location":"Contour%20Labeling%20Tool/Changelog/","text":"V1.2.0 Functionality: Add a toggle button called \"Pan\" to activate or deactivate panning/zooming images by mouse dragging or scrolling. Support moving selected contours by pressing arrow keys. Add a prompt window when starting AI lumen/wall segmentation, within which users can: Select a sequence to run the AI (previously \"S101\" will be automatically used). Check a checkbox to perform AI only for those slices with no lumen or wall contour. The checkbox is checked by default. Add a toggle button called \"Drag Control\" above the intensity window table. When it is enabled, dragging mouse on images can adjust window level and width. UI: Adjust column margin in tables to make them more compact Show tips when hovering over the Shift, MPR, or Pan buttons. Add text instructions in two prompt windows: Selecting sequences to show after opening a cross-sectional (MOCHA) folder, Selecting vessel types to extract cross-sections after opening a VesselVoyager folder. Adjust positions of some buttons. V1.1.4 Functionality: Support selecting contour keypoints by clicking, and deleting selected keypoints by pressing the delete key. Support adding keypoints to an existing contour by ctrl+clicking on the contour. V1.1.3 UI: Heights of the cross-sectional and MPR windows become adjustable through a vertical splitter. In the left panel, the widgets below the buttons now stretch over the entire vertical space. Functionality: Add a horizontal line on each MPR window to show the location corresponding to the cross-sectional slice. Add linear interpolation mode to smooth image, which can be enable through the menubar, Settings/Smooth Image . Support copying and pasting selected contours using conventional hot keys. Bug fix: Fix the bug that when MRP view is enable, the MPR image does not correspond to the rotation line on the cross-sectional slice (it corresponds to the line obtained by flipping the rotation line along the diagonal). Fix the but that after selecting contours and moving to another slice, the selected contours stored in the background are not removed. V1.1.2 Bug fixes: Fix the bug that the software fails to open an folder if the nii files are named as \"xsec_{whatever}_{seq}.nii.gz\u201c rather than \"xsec_{seq}.nii.gz\" . V1.1.0 Functionality: Support AI prediction for lumen and outer wall. V1.0.1 Bug fixes: When a data folder has already been opened, the user now can open another folder. Previously nothing would happen after the user do this. Functionality: Support multiple project (QVJ) files in the same folder. A pop-up window will ask the user to select one QVJ to read contours. V1.0.0 Initial release","title":"Changelog"},{"location":"Contour%20Labeling%20Tool/Changelog/#v120","text":"Functionality: Add a toggle button called \"Pan\" to activate or deactivate panning/zooming images by mouse dragging or scrolling. Support moving selected contours by pressing arrow keys. Add a prompt window when starting AI lumen/wall segmentation, within which users can: Select a sequence to run the AI (previously \"S101\" will be automatically used). Check a checkbox to perform AI only for those slices with no lumen or wall contour. The checkbox is checked by default. Add a toggle button called \"Drag Control\" above the intensity window table. When it is enabled, dragging mouse on images can adjust window level and width. UI: Adjust column margin in tables to make them more compact Show tips when hovering over the Shift, MPR, or Pan buttons. Add text instructions in two prompt windows: Selecting sequences to show after opening a cross-sectional (MOCHA) folder, Selecting vessel types to extract cross-sections after opening a VesselVoyager folder. Adjust positions of some buttons.","title":"V1.2.0"},{"location":"Contour%20Labeling%20Tool/Changelog/#v114","text":"Functionality: Support selecting contour keypoints by clicking, and deleting selected keypoints by pressing the delete key. Support adding keypoints to an existing contour by ctrl+clicking on the contour.","title":"V1.1.4"},{"location":"Contour%20Labeling%20Tool/Changelog/#v113","text":"UI: Heights of the cross-sectional and MPR windows become adjustable through a vertical splitter. In the left panel, the widgets below the buttons now stretch over the entire vertical space. Functionality: Add a horizontal line on each MPR window to show the location corresponding to the cross-sectional slice. Add linear interpolation mode to smooth image, which can be enable through the menubar, Settings/Smooth Image . Support copying and pasting selected contours using conventional hot keys. Bug fix: Fix the bug that when MRP view is enable, the MPR image does not correspond to the rotation line on the cross-sectional slice (it corresponds to the line obtained by flipping the rotation line along the diagonal). Fix the but that after selecting contours and moving to another slice, the selected contours stored in the background are not removed.","title":"V1.1.3"},{"location":"Contour%20Labeling%20Tool/Changelog/#v112","text":"Bug fixes: Fix the bug that the software fails to open an folder if the nii files are named as \"xsec_{whatever}_{seq}.nii.gz\u201c rather than \"xsec_{seq}.nii.gz\" .","title":"V1.1.2"},{"location":"Contour%20Labeling%20Tool/Changelog/#v110","text":"Functionality: Support AI prediction for lumen and outer wall.","title":"V1.1.0"},{"location":"Contour%20Labeling%20Tool/Changelog/#v101","text":"Bug fixes: When a data folder has already been opened, the user now can open another folder. Previously nothing would happen after the user do this. Functionality: Support multiple project (QVJ) files in the same folder. A pop-up window will ask the user to select one QVJ to read contours.","title":"V1.0.1"},{"location":"Contour%20Labeling%20Tool/Changelog/#v100","text":"Initial release","title":"V1.0.0"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/","text":"The key function of this software is to label contours on images. Each contour has a type name (such as \"Lumen\" or \"Outer Wall\"). Each type of contours has the same color if shown. A contour contains a closed curve and several key points (figure below). The curve is determined by the key points through a smooth B-spline curve interpolation. You can control the shape of the contour by controlling those key points, such as moving their locations, adding or deleting key points. The tools for contour labeling are in a table (figure below) on the left panel. Each row corresponds to a contour type. Show/hide contours By default, all contours are hidden after opening the software. To show all contours of a certain type, you can check the checkbox in the show column and the row corresponding to that contour type. For example, the status of the checkboxes in the above figure indicates that the \"Lumen\" and \"Outer Wall\" contours are shown, while the \"Calcification\" contours (if exist) are hidden. Draw new contours To draw a new contour, you can first activate the contour drawing mode by clicking the button in the draw column and the row corresponding to that contour type. The button will become blue, showing the activation status. Another alternative way is to press the number key corresponding to the contour type. For example, to activate drawing \"Lumen\" contours, just press 1 . Once the drawing mode is activated, you can click a location in a image sequence window to add a key point. Click multiple times to add multiple keypoints. Once you think the newly added keypoints are sufficient, click the previous button in the draw column, or press the number key again to deactivate the drawing mode. A curve will be automatically generated to represented the contour based on the keypoints. The pipeline \"activate drawing mode\" - \"add key points\" - \"deactivate drawing mode\" will generate one single contour. If you want to draw another contour, then perform this pipeline again. Same contour for all image sequences If you draw a contour on one sequence, after finishing drawing, the same contour will appear on all sequence. This is similar to 2D CASCADE. This implies you are drawing contours based on all the sequences. Minimum number of key points You need to add at least three key points in order to generate a contour. If the number of newly added key points is less than 3 when you deactivate the drawing mode, all key points will be removed and no contour will be generated. Drawing mode is exclusive for one contour type The drawing mode can only be activated for one single contour type at the same time. If you have activated the drawing mode for type 1 (e.g., \"Lumen\"), and then activate the drawing mode for type 2 (e.g., \"Outer Wall\"), the drawing mode for type 1 will be automatically deactivated, and any key points you have added after activating the drawing mode for type 1 will be used to generate a contour of type 1. Automatically showing contours after activating drawing mode If you activate drawing mode for type 1 contour, and you haven't checked the checkbox in the show column for type 1, then this checkbox will automatically be checked and all existing type 1 contours will show. The logic here is that you cannot draw a type 1 contour if you have hidden type 1. In contrast, if you uncheck a checkbox in the draw column before you deactivate the drawing mode for the same contour type, the drawing mode will be automatically deactivated, and a new contour will be generated (if there are more than three newly added key points) and then hidden. Change contour shape You can drag a key point on a contour in an image sequence window, and then the shape of the contour curve will change accordingly in real time in all image sequence windows. This is useful to adjust the shape of an existing contour, without deleting it and drawing a new one. Select contours or key points You can click on an existing contour (but not on a key point) to select that contour. The selected contours are highlighted with a white color and a slightly thicker width. You can click on a key point to select it. The selected key points are highlighted with a white color. You cannot select a contours and a key point at the same time. Delete existing contours or key points To delete an existing contour, just select it and then press Del . The contour curve and key points will be removed and this operation cannot be undone. To delete an existing key point, just select it and then press Del . The selected key points will be removed, and the contour curve will be regenerated based on the rest of the key points. This is useful if you think the key points are too many. Add key points to existing contours You can add a key point to an existing contour, by Ctrl + clicking any location on the contour. A key point will be added at that location, and the contour curve will be regenerated based on all key points (including the new one). Move contours You can spatially translate selected contours by pressing the arrow keys Up , Down , Left or Right . Copy and paste contours You can copy selected contours by Ctrl + C . You can then navigate to another slice, and paste those contours by Ctrl + V . Note that if there exists the same contour, then pasting will not perform. Change colors or type names You can click a color block in the color column to change the color of the corresponding contour type in a prompt window. You can also double-click a table cell in the type column to change the corresponding contour type name. Note that you cannot change it to a name that has been used by another contour type (a prompt window will show this information if you try to do that). Add new types You can add a new contour type. To do so, in the menubar click Contour \u2192 Add New Type , then a new row will appear in the contour table. The default name of the new contour type is \"tmp*\", you may change the name and the color to make it fit the need. Delete contour types You can delete a contour type from the contour table, and in this way, all the existing contours (no matter whether they are visible) of this type will be deleted. To do so, just click the corresponding row in the table to select the row, then in the menubar click Contour \u2192 Delete Selected Types , then click yes in the prompt window. Do NOT delete the default contour types. There are some default contour types defined by 2D CASCADE. They will all appear in the contour table, even if there is no corresponding contour labels on the opened images. To avoid potential confilcts and bugs occured by CASCADE, the following things are not recommended: Delete a default contour type. Add a new contour type with a name similar to the name of a default contour type. Change the color of a default contour type. The default types are: 'Lumen', 'Outer Wall', 'Calcification', 'Necrotic/Lipid Core', 'Loose Matrix', 'Type I Hemorrhage', 'Type II Hemorrhage', 'Ulcer', 'Thrombus', 'Other Types', 'Fibrous', 'Fibrous - CA', 'Fibrous - LM', 'Lipid Accumulation', 'Hemorrhage Out Core', 'ECA Lumen': '187', 'ECA Wall', 'Shoulder', 'Muscle', 'Vesselwall Centerline'. Warning The operation of deleting a contour type cannot be undone. All information of the contour type will be lost, including the shape and position of each contour and the color and name of the contour type. If you regret after deleting a contour type, then you need to close the software without saving to prevent the results from being saved.","title":"Contour Labeling"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#showhide-contours","text":"By default, all contours are hidden after opening the software. To show all contours of a certain type, you can check the checkbox in the show column and the row corresponding to that contour type. For example, the status of the checkboxes in the above figure indicates that the \"Lumen\" and \"Outer Wall\" contours are shown, while the \"Calcification\" contours (if exist) are hidden.","title":"Show/hide contours"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#draw-new-contours","text":"To draw a new contour, you can first activate the contour drawing mode by clicking the button in the draw column and the row corresponding to that contour type. The button will become blue, showing the activation status. Another alternative way is to press the number key corresponding to the contour type. For example, to activate drawing \"Lumen\" contours, just press 1 . Once the drawing mode is activated, you can click a location in a image sequence window to add a key point. Click multiple times to add multiple keypoints. Once you think the newly added keypoints are sufficient, click the previous button in the draw column, or press the number key again to deactivate the drawing mode. A curve will be automatically generated to represented the contour based on the keypoints. The pipeline \"activate drawing mode\" - \"add key points\" - \"deactivate drawing mode\" will generate one single contour. If you want to draw another contour, then perform this pipeline again. Same contour for all image sequences If you draw a contour on one sequence, after finishing drawing, the same contour will appear on all sequence. This is similar to 2D CASCADE. This implies you are drawing contours based on all the sequences. Minimum number of key points You need to add at least three key points in order to generate a contour. If the number of newly added key points is less than 3 when you deactivate the drawing mode, all key points will be removed and no contour will be generated. Drawing mode is exclusive for one contour type The drawing mode can only be activated for one single contour type at the same time. If you have activated the drawing mode for type 1 (e.g., \"Lumen\"), and then activate the drawing mode for type 2 (e.g., \"Outer Wall\"), the drawing mode for type 1 will be automatically deactivated, and any key points you have added after activating the drawing mode for type 1 will be used to generate a contour of type 1. Automatically showing contours after activating drawing mode If you activate drawing mode for type 1 contour, and you haven't checked the checkbox in the show column for type 1, then this checkbox will automatically be checked and all existing type 1 contours will show. The logic here is that you cannot draw a type 1 contour if you have hidden type 1. In contrast, if you uncheck a checkbox in the draw column before you deactivate the drawing mode for the same contour type, the drawing mode will be automatically deactivated, and a new contour will be generated (if there are more than three newly added key points) and then hidden.","title":"Draw new contours"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#change-contour-shape","text":"You can drag a key point on a contour in an image sequence window, and then the shape of the contour curve will change accordingly in real time in all image sequence windows. This is useful to adjust the shape of an existing contour, without deleting it and drawing a new one.","title":"Change contour shape"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#select-contours-or-key-points","text":"You can click on an existing contour (but not on a key point) to select that contour. The selected contours are highlighted with a white color and a slightly thicker width. You can click on a key point to select it. The selected key points are highlighted with a white color. You cannot select a contours and a key point at the same time.","title":"Select contours or key points"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#delete-existing-contours-or-key-points","text":"To delete an existing contour, just select it and then press Del . The contour curve and key points will be removed and this operation cannot be undone. To delete an existing key point, just select it and then press Del . The selected key points will be removed, and the contour curve will be regenerated based on the rest of the key points. This is useful if you think the key points are too many.","title":"Delete existing contours or key points"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#add-key-points-to-existing-contours","text":"You can add a key point to an existing contour, by Ctrl + clicking any location on the contour. A key point will be added at that location, and the contour curve will be regenerated based on all key points (including the new one).","title":"Add key points to existing contours"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#move-contours","text":"You can spatially translate selected contours by pressing the arrow keys Up , Down , Left or Right .","title":"Move contours"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#copy-and-paste-contours","text":"You can copy selected contours by Ctrl + C . You can then navigate to another slice, and paste those contours by Ctrl + V . Note that if there exists the same contour, then pasting will not perform.","title":"Copy and paste contours"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#change-colors-or-type-names","text":"You can click a color block in the color column to change the color of the corresponding contour type in a prompt window. You can also double-click a table cell in the type column to change the corresponding contour type name. Note that you cannot change it to a name that has been used by another contour type (a prompt window will show this information if you try to do that).","title":"Change colors or type names"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#add-new-types","text":"You can add a new contour type. To do so, in the menubar click Contour \u2192 Add New Type , then a new row will appear in the contour table. The default name of the new contour type is \"tmp*\", you may change the name and the color to make it fit the need.","title":"Add new types"},{"location":"Contour%20Labeling%20Tool/Contour%20Labeling/#delete-contour-types","text":"You can delete a contour type from the contour table, and in this way, all the existing contours (no matter whether they are visible) of this type will be deleted. To do so, just click the corresponding row in the table to select the row, then in the menubar click Contour \u2192 Delete Selected Types , then click yes in the prompt window. Do NOT delete the default contour types. There are some default contour types defined by 2D CASCADE. They will all appear in the contour table, even if there is no corresponding contour labels on the opened images. To avoid potential confilcts and bugs occured by CASCADE, the following things are not recommended: Delete a default contour type. Add a new contour type with a name similar to the name of a default contour type. Change the color of a default contour type. The default types are: 'Lumen', 'Outer Wall', 'Calcification', 'Necrotic/Lipid Core', 'Loose Matrix', 'Type I Hemorrhage', 'Type II Hemorrhage', 'Ulcer', 'Thrombus', 'Other Types', 'Fibrous', 'Fibrous - CA', 'Fibrous - LM', 'Lipid Accumulation', 'Hemorrhage Out Core', 'ECA Lumen': '187', 'ECA Wall', 'Shoulder', 'Muscle', 'Vesselwall Centerline'. Warning The operation of deleting a contour type cannot be undone. All information of the contour type will be lost, including the shape and position of each contour and the color and name of the contour type. If you regret after deleting a contour type, then you need to close the software without saving to prevent the results from being saved.","title":"Delete contour types"},{"location":"Contour%20Labeling%20Tool/Data%20Reading/","text":"Folder format The first step is to open a folder by the tool, such that images and contours (if exist) can be displayed. The following types of folders are supported: - MOCHA folder: contains NIfTI ( .nii.gz ) files of MPR (cross-sectional) images, - VesselVoyager folder: contains NIfTI files of 3D images and a yaml file of centerline coordinates, - 2D CASCADE project folder: contains DICOM, .QVJ and .QVS files. MOCHA folder The folder should contain NIfTI files of MPR (cross-sectional) images. Each file is named as xsec_{seq}.nii.gz or xsec_{whatever}_{seq}.nii.gz . Here, {seq} is any name that indicates the MR sequence name, such as S101 or pre-T1 ; {whatever} can be any name. Restriction for {seq} and {whatever} The only restriction: they should not contain the underline _ . To open a folder, click the menubar, File \u2192 Open Xsec Folder . Then select the folder you want to open. If multiple sequences are detected, a prompt window will ask you to select the sequences you want to show (figure below). By default, all sequences are selected. VesselVoyager folder The folder should contain NIfTI files of 3D images. Each file is named as {seq}.nii.gz . Here, {seq} is any name that indicates the MR sequence name, such as TOF . The folder should also contain a centerline.yml yaml file that contains centerline information following VesselVoyager's format. To open a folder, click the menubar, File \u2192 Open 3D . Then select the folder you want to open. A prompt window will ask you which vessels you want to extract cross-sectional images from (figure below). By default, all vessels are selected. Select some by checking the checkboxs and click OK. Once the extraction is completed, each selected vessel will have a corresponding MOCHA folder named {vessel}_{ID} stored in the xsec folder in the VesselVoyager folder, where {vessel} is the vessel name, and {ID} is a unique ID for that vessel. One MOCHA folder will be automatically opened. The following things will be the same as after opening a MOCHA folder. 2D CASCADE folder To open a 2D CASCADE folder: In the menubar, click File \u2192 Open Folder In the pop-up window, select a CASCADE project folder, which should contains QVS , QVJ and dcm files. Note that you need to select the folder itself, rather than the QVJ file in the folder. Wait for a while, the tool will read the images and contour information, then display the images. New in V1.0.1 The tool support multiple project ( .QVJ ) files in the same folder. If it detects that, a pop-up window will ask the user to select one QVJ file to read. This is useful especially for some carotid datasets, in which there could be two QVJ files, for the left and right carotid arteries, respectively. GUI After opening a folder, the GUI will appear. Then you can start to use it. There are splitters in the software window. For example: You can drag them to adjust the size of different subwindows. You can even drag a splitter to make some subwindows disappear or appear again. Quickly open another folder There is a folder tree on the left panel (figure below) that shows all folders at the same level of the currently opened folder. To quickly open one of those folders, double click the folder name. A prompt window will ask whether you want to save your changes before opening another folder. Click one of the buttons: Yes: save results and then close the software. No: discard unsaved results, and then close the software. Cancel: do not save results, nor close the software. In other words, nothing will happen. This is very useful if you are reviewing multiple folders, such as different vessels of the same subject from VesselVoyager.","title":"Data Reading"},{"location":"Contour%20Labeling%20Tool/Data%20Reading/#folder-format","text":"The first step is to open a folder by the tool, such that images and contours (if exist) can be displayed. The following types of folders are supported: - MOCHA folder: contains NIfTI ( .nii.gz ) files of MPR (cross-sectional) images, - VesselVoyager folder: contains NIfTI files of 3D images and a yaml file of centerline coordinates, - 2D CASCADE project folder: contains DICOM, .QVJ and .QVS files.","title":"Folder format"},{"location":"Contour%20Labeling%20Tool/Data%20Reading/#mocha-folder","text":"The folder should contain NIfTI files of MPR (cross-sectional) images. Each file is named as xsec_{seq}.nii.gz or xsec_{whatever}_{seq}.nii.gz . Here, {seq} is any name that indicates the MR sequence name, such as S101 or pre-T1 ; {whatever} can be any name. Restriction for {seq} and {whatever} The only restriction: they should not contain the underline _ . To open a folder, click the menubar, File \u2192 Open Xsec Folder . Then select the folder you want to open. If multiple sequences are detected, a prompt window will ask you to select the sequences you want to show (figure below). By default, all sequences are selected.","title":"MOCHA folder"},{"location":"Contour%20Labeling%20Tool/Data%20Reading/#vesselvoyager-folder","text":"The folder should contain NIfTI files of 3D images. Each file is named as {seq}.nii.gz . Here, {seq} is any name that indicates the MR sequence name, such as TOF . The folder should also contain a centerline.yml yaml file that contains centerline information following VesselVoyager's format. To open a folder, click the menubar, File \u2192 Open 3D . Then select the folder you want to open. A prompt window will ask you which vessels you want to extract cross-sectional images from (figure below). By default, all vessels are selected. Select some by checking the checkboxs and click OK. Once the extraction is completed, each selected vessel will have a corresponding MOCHA folder named {vessel}_{ID} stored in the xsec folder in the VesselVoyager folder, where {vessel} is the vessel name, and {ID} is a unique ID for that vessel. One MOCHA folder will be automatically opened. The following things will be the same as after opening a MOCHA folder.","title":"VesselVoyager folder"},{"location":"Contour%20Labeling%20Tool/Data%20Reading/#2d-cascade-folder","text":"To open a 2D CASCADE folder: In the menubar, click File \u2192 Open Folder In the pop-up window, select a CASCADE project folder, which should contains QVS , QVJ and dcm files. Note that you need to select the folder itself, rather than the QVJ file in the folder. Wait for a while, the tool will read the images and contour information, then display the images. New in V1.0.1 The tool support multiple project ( .QVJ ) files in the same folder. If it detects that, a pop-up window will ask the user to select one QVJ file to read. This is useful especially for some carotid datasets, in which there could be two QVJ files, for the left and right carotid arteries, respectively.","title":"2D CASCADE folder"},{"location":"Contour%20Labeling%20Tool/Data%20Reading/#gui","text":"After opening a folder, the GUI will appear. Then you can start to use it. There are splitters in the software window. For example: You can drag them to adjust the size of different subwindows. You can even drag a splitter to make some subwindows disappear or appear again.","title":"GUI"},{"location":"Contour%20Labeling%20Tool/Data%20Reading/#quickly-open-another-folder","text":"There is a folder tree on the left panel (figure below) that shows all folders at the same level of the currently opened folder. To quickly open one of those folders, double click the folder name. A prompt window will ask whether you want to save your changes before opening another folder. Click one of the buttons: Yes: save results and then close the software. No: discard unsaved results, and then close the software. Cancel: do not save results, nor close the software. In other words, nothing will happen. This is very useful if you are reviewing multiple folders, such as different vessels of the same subject from VesselVoyager.","title":"Quickly open another folder"},{"location":"Contour%20Labeling%20Tool/Data%20Saving/","text":"Saving back to a 2D CASCADE folder This tool is under active development and may have some bugs that could destroy the original CASCADE data if the opened folder is a 2D CASCADE folder. So before saving, it is strongly recommended that you back up all the QVJ and QVS files in the CASCADE folder. The dicom files do not need to be backed up. If the opened folder is a MOCHA or VesseyVoyager folder, no back up is needed also. You can click save button (figure below) on the left panel to save current results back to the opened folder. An alternative way is to click the menubar, File \u2192 Save. When saving the data, a message and a progress bar will appear in the status bar at the bottom of the software window to indicate the progress. Once saving is finished (usually in 0.5 seconds), the progress bar will disappear, and the message will show \"finished\": New in V1.1.0 When closing the software window, a prompt window (figure below) will ask whether you want to save results before closing. Click one of the buttons: Yes: save results and then close the software. No: discard unsaved results, and then close the software. Cancel: do not save results, nor close the software. In other words, nothing will happen.","title":"Data Saving"},{"location":"Contour%20Labeling%20Tool/Image%20Display/","text":"The displayed images are indicated by the red box in the figure below: Basic information Each image sequence is show in one individual window. Path of the opened folder is show at the top. Index of the shown slice and the total number of slices are shown in the upper left corner of each sequence window. Sequence names are shown in the upper right corner of each sequence window. Image boundary is indicated by four blue lines (two horizontal and two vertical). Pan and zoom When the Pan button (figure below) in the left panel is activated (by default), you can: Drag mouse in any sequence window to pan (move) the image. Scroll up/down when the mouse is in any sequence window to zoom in/out. Note that all the sequence windows will behave in the same way as you pan or zoom. In other words, the viewing range of the images of all sequences is synchronized automatically. At any time, you can click the Rescale Button (figure below) to immediately rescale all images to their original viewing range. This is useful if you accidentally pan or zoom too much and want to recover. Navigate to another slice The sequence windows only show one same slice for each sequence. To change the shown slice, you can use one of the following ways: Press Q or E to move to the previous or next slice. Type an integer in the textbox of slice index (figure below). When you are typing in a textbox, you can also press Up or Down to increase or decrease the number. Change intensity windows The intensity windows for each sequence are shown as a table in the left panel: The table contains the following information: Sequence names. Min and max values of the intensity windows. Note that the min/max values have a relationship with the window level and width: \\[ \\begin{aligned} \\text{min}=\\text{Level}-\\frac{\\text{Width}}{2}\\\\ \\text{max}=\\text{Level}+\\frac{\\text{Width}}{2} \\end{aligned} \\] When the Drag Control button is activated, you can drag your mouse in any sequence window to change the window level/width of that image sequence. The behavior is the same as the Radiant software for viewing Dicom images. Specifically: Drag up/down to increase/decrease window level. Drag right/left to increase/decrease window width. Mutually exclusive with the Pan button Since dragging mouse has different effects when the Pan or Drag Control button is activated, these two buttons are mutually exclusive. In other words, activating one of them will automatically deactivate the other. Image rendering mode By default, the images are rendered through nearest-neighbor interpolation. As a result, you may observe clear square-like boundaries between adjacent pixels. To view images under a smooth mode, click the menubar, Settings \u2192 Smooth Image , then the images are rendered through linear interpolation, like other software such as 2D CASCADE and Radiant. To change the mode back, click it again. A comparison between the two modes: Recommended mode The nearest-neighbor mode is recommended and thus activated by default. This is because it shows the real appearance of the original image, which is essentially a discrete grid of pixels. The clear boundaries between adjacent pixels in this mode could help better identify the boundary of tissues, leading to a more accurate manual contour labeling. MPR views There are theoretically two ways to view an image: View the cross-sectional 2D slices. View the longitudinal 2D slices, a.k.a. the MPR view. By default, only the cross-sectional slices are shown. To also show the MPR view, click the MPR button (figure below). To hide the MPR view, click it again. Then, the GUI will look like: Key components include: \u2460 A red line segment that indicates the cropping direction corresponding to the MPR view. You can drag the small circle on the line segment to rotate it. You can also drag the small squares at the endpoints of the line segment, to move the line segment such that it will not go through the image center anymore. The MPR view will change according to the location and orientation of the line segment. \u2461 A horizontal blue line on each MPR window that indicates the current slice index. If you change the shown slice, this line will move accordingly. \u2462 A splitter that can be dragged to change the heights of the cross-section and MPR windows. Manually register images Theoretically, all the sequences have been registered (spatially aligned) before using this software. However, there could be non-perfect registration, such that you may observe structure misalignment of certain cross-sectional slices. 2D CASCADE provides a tool to manually move (translate) a slice of one sequence such that it can better align with other sequences. To do so in this software, click the Shift button to activate the manual registration mode: Then you can drag in any sequence window to move that slice. Once you finish, remember to deactivate the registration mode by clicking the button again. The resulting slice could look like: Note that when you register the slice by dragging, the image will be moved, but the blue lines indicating the image boundary will be fixed. Potential bug When the Shift and Pan buttons are both activated, sometimes dragging the images will not have effect on register the images, instead, all the images will move together as if you are panning them. Next version will fix this issue. Currently, it is recommended to deactivated Pan before using Shift .","title":"Image Display"},{"location":"Contour%20Labeling%20Tool/Image%20Display/#basic-information","text":"Each image sequence is show in one individual window. Path of the opened folder is show at the top. Index of the shown slice and the total number of slices are shown in the upper left corner of each sequence window. Sequence names are shown in the upper right corner of each sequence window. Image boundary is indicated by four blue lines (two horizontal and two vertical).","title":"Basic information"},{"location":"Contour%20Labeling%20Tool/Image%20Display/#pan-and-zoom","text":"When the Pan button (figure below) in the left panel is activated (by default), you can: Drag mouse in any sequence window to pan (move) the image. Scroll up/down when the mouse is in any sequence window to zoom in/out. Note that all the sequence windows will behave in the same way as you pan or zoom. In other words, the viewing range of the images of all sequences is synchronized automatically. At any time, you can click the Rescale Button (figure below) to immediately rescale all images to their original viewing range. This is useful if you accidentally pan or zoom too much and want to recover.","title":"Pan and zoom"},{"location":"Contour%20Labeling%20Tool/Image%20Display/#navigate-to-another-slice","text":"The sequence windows only show one same slice for each sequence. To change the shown slice, you can use one of the following ways: Press Q or E to move to the previous or next slice. Type an integer in the textbox of slice index (figure below). When you are typing in a textbox, you can also press Up or Down to increase or decrease the number.","title":"Navigate to another slice"},{"location":"Contour%20Labeling%20Tool/Image%20Display/#change-intensity-windows","text":"The intensity windows for each sequence are shown as a table in the left panel: The table contains the following information: Sequence names. Min and max values of the intensity windows. Note that the min/max values have a relationship with the window level and width: \\[ \\begin{aligned} \\text{min}=\\text{Level}-\\frac{\\text{Width}}{2}\\\\ \\text{max}=\\text{Level}+\\frac{\\text{Width}}{2} \\end{aligned} \\] When the Drag Control button is activated, you can drag your mouse in any sequence window to change the window level/width of that image sequence. The behavior is the same as the Radiant software for viewing Dicom images. Specifically: Drag up/down to increase/decrease window level. Drag right/left to increase/decrease window width. Mutually exclusive with the Pan button Since dragging mouse has different effects when the Pan or Drag Control button is activated, these two buttons are mutually exclusive. In other words, activating one of them will automatically deactivate the other.","title":"Change intensity windows"},{"location":"Contour%20Labeling%20Tool/Image%20Display/#image-rendering-mode","text":"By default, the images are rendered through nearest-neighbor interpolation. As a result, you may observe clear square-like boundaries between adjacent pixels. To view images under a smooth mode, click the menubar, Settings \u2192 Smooth Image , then the images are rendered through linear interpolation, like other software such as 2D CASCADE and Radiant. To change the mode back, click it again. A comparison between the two modes: Recommended mode The nearest-neighbor mode is recommended and thus activated by default. This is because it shows the real appearance of the original image, which is essentially a discrete grid of pixels. The clear boundaries between adjacent pixels in this mode could help better identify the boundary of tissues, leading to a more accurate manual contour labeling.","title":"Image rendering mode"},{"location":"Contour%20Labeling%20Tool/Image%20Display/#mpr-views","text":"There are theoretically two ways to view an image: View the cross-sectional 2D slices. View the longitudinal 2D slices, a.k.a. the MPR view. By default, only the cross-sectional slices are shown. To also show the MPR view, click the MPR button (figure below). To hide the MPR view, click it again. Then, the GUI will look like: Key components include: \u2460 A red line segment that indicates the cropping direction corresponding to the MPR view. You can drag the small circle on the line segment to rotate it. You can also drag the small squares at the endpoints of the line segment, to move the line segment such that it will not go through the image center anymore. The MPR view will change according to the location and orientation of the line segment. \u2461 A horizontal blue line on each MPR window that indicates the current slice index. If you change the shown slice, this line will move accordingly. \u2462 A splitter that can be dragged to change the heights of the cross-section and MPR windows.","title":"MPR views"},{"location":"Contour%20Labeling%20Tool/Image%20Display/#manually-register-images","text":"Theoretically, all the sequences have been registered (spatially aligned) before using this software. However, there could be non-perfect registration, such that you may observe structure misalignment of certain cross-sectional slices. 2D CASCADE provides a tool to manually move (translate) a slice of one sequence such that it can better align with other sequences. To do so in this software, click the Shift button to activate the manual registration mode: Then you can drag in any sequence window to move that slice. Once you finish, remember to deactivate the registration mode by clicking the button again. The resulting slice could look like: Note that when you register the slice by dragging, the image will be moved, but the blue lines indicating the image boundary will be fixed. Potential bug When the Shift and Pan buttons are both activated, sometimes dragging the images will not have effect on register the images, instead, all the images will move together as if you are panning them. Next version will fix this issue. Currently, it is recommended to deactivated Pan before using Shift .","title":"Manually register images"}]}